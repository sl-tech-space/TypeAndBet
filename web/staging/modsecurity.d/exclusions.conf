# ===== ModSecurity 3.0 除外設定（ベストプラクティス） =====

# ヘルスチェックと静的ファイルの除外
SecRule REQUEST_URI "@contains /health" \
    "id:3001,phase:1,t:none,log,allow,msg:'Health check endpoint'"

SecRule REQUEST_URI "@contains /_next/static" \
    "id:3002,phase:1,t:none,log,allow,msg:'Next.js static files'"

SecRule REQUEST_URI "@contains /robots.txt" \
    "id:3003,phase:1,t:none,log,allow,msg:'Robots.txt access'"

# 静的ファイルの除外（パフォーマンス向上）
SecRule REQUEST_URI "@contains /assets" \
    "id:3004,phase:1,t:none,log,allow,msg:'Static assets - no security check needed'"

SecRule REQUEST_URI "@contains /images" \
    "id:3005,phase:1,t:none,log,allow,msg:'Image files - no security check needed'"

SecRule REQUEST_URI "@contains /svg" \
    "id:3006,phase:1,t:none,log,allow,msg:'SVG files - no security check needed'"

# ゲームAPI用の除外ルール（高頻度リクエスト）
SecRule REQUEST_URI "@contains /api/games" \
    "id:3007,phase:1,t:none,log,allow,msg:'Game API endpoint - high frequency allowed'"

SecRule REQUEST_URI "@contains /api/betting" \
    "id:3008,phase:1,t:none,log,allow,msg:'Betting API endpoint - high frequency allowed'"

SecRule REQUEST_URI "@contains /api/result" \
    "id:3009,phase:1,t:none,log,allow,msg:'Result API endpoint - high frequency allowed'"

SecRule REQUEST_URI "@contains /api/ranking" \
    "id:3010,phase:1,t:none,log,allow,msg:'Ranking API endpoint - high frequency allowed'"

# WebSocket接続用の除外ルール
SecRule REQUEST_URI "@contains /ws" \
    "id:3011,phase:1,t:none,log,allow,msg:'WebSocket endpoint - real-time game updates'"

SecRule REQUEST_URI "@contains /socket.io" \
    "id:3012,phase:1,t:none,log,allow,msg:'Socket.IO endpoint - real-time game updates'"

# ゲーム用の特別なレート制限除外
SecRule REQUEST_URI "@contains /api/games/health" \
    "id:3013,phase:1,t:none,log,allow,msg:'Game health check - no rate limit'"

SecRule REQUEST_URI "@contains /api/games/status" \
    "id:3014,phase:1,t:none,log,allow,msg:'Game status check - no rate limit'"
